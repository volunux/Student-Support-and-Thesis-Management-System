(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{"6lis":function(e,t,r){"use strict";r.r(t),r.d(t,"GeneralRequestEntryCreateModule",function(){return M});var s=r("Yvf7"),n=r("8VHZ"),i=r("hxwH"),a=r("0FyI"),o=r("Fk62"),c=r("jiyY"),l=r("iojP"),h=r("Ub9n");let u=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Eb({type:e,selectors:[["app-gr-entry-create-homepage"]],decls:1,vars:0,template:function(e,t){1&e&&h.Lb(0,"router-outlet")},directives:[o.h],styles:[""]}),e})();var p=r("XA6Z");let y=[{label:"Photo I",key:"photos",accepts:"image/*",controlType:"file"},{label:"Photo II",key:"photos",accepts:"image/*",controlType:"file"},{label:"Photo III",key:"photos",accepts:"image/*",controlType:"file"},{label:"Photo IV",key:"photos",accepts:"image/*",controlType:"file"}],g={add:"user-upload/entry/create",remove:"o/photo",sign:"o/sign/photo"};var b=r("EUGn"),d=r("vlQ6"),m=r("jV/k"),f=r("vfyW"),v=r("XRyL"),C=r("O6Zd"),E=r("oECA"),T=r("VcWf"),w=r("FBrc");let q=(()=>{class e{constructor(e,t,r){this.http=e,this.apiConfig=t,this.ems=r,this.$systemType="General Request",this.$sa="general-request"}addEntry(e){return this.http.get(`${this.apiConfig.host}/${this.$sa}/t/${e}/entry/create`).pipe(Object(f.a)(e=>console.log(e)),Object(v.a)(3e3),Object(C.a)(e=>({permitted:!0,$data:e})),Object(E.a)(this.handleError(this.$systemType+" Entry",null)))}addEntry$(e,t){let r=`${this.apiConfig.host}/${this.$sa}/t/${e}/entry/create`;return console.log(t),this.http.post(r,t).pipe(Object(f.a)(e=>console.log(e)),Object(C.a)(e=>({created:!0,$data:e})),Object(E.a)(this.handleError(this.$systemType+" Entry",null)))}handleError(e="operation",t){return e=>(this.ems.message=e,Object(m.a)(t))}}return e.\u0275fac=function(t){return new(t||e)(h.Tb(w.b),h.Tb(T.b),h.Tb(b.a))},e.\u0275prov=h.Gb({token:e,factory:e.\u0275fac}),e})(),I=(()=>{class e{constructor(e){this.fb=e,this.permanentData={},this.otherCtrls={request_type:[n.o.required,n.o.max(9e7)],unit:[n.o.required,n.o.max(9e7)],username:[n.o.minLength(5),n.o.maxLength(100)],password:[n.o.minLength(5),n.o.maxLength(100)]}}getMyData(e){return this.permanentData[e]}}return e.\u0275fac=function(t){return new(t||e)(h.Tb(n.b))},e.\u0275prov=h.Gb({token:e,factory:e.\u0275fac}),e})();var O=r("5bm+"),$=r("WEao"),j=r("uMT1"),L=r("TY4h"),k=r("wczn");function G(e,t){if(1&e&&(h.Pb(0,"h2"),h.xc(1),h.Ob()),2&e){const e=h.ac();h.zb(1),h.yc(" ",e.title," ")}}function F(e,t){if(1&e&&h.Lb(0,"app-resource-unavailable",4),2&e){const e=h.ac();h.gc("error",e.error)}}function x(e,t){if(1&e){const e=h.Qb();h.Nb(0),h.Pb(1,"app-request-entry-create",5),h.Wb("processEntry",function(t){return h.rc(e),h.ac(2).createEntry(t)}),h.Ob(),h.Mb()}if(2&e){const e=h.ac(2);h.zb(1),h.gc("system-type",e.systemType)("system-guideline",e.systemGuideline)("view",e.view)("input-file-control",e.fileControl)("attachment-config",e.attachmentConfig)("entry-create-form",e.entryCreateForm)("upload-config-u",e.uploadConfig)}}function z(e,t){if(1&e&&(h.Nb(0),h.vc(1,x,2,7,"ng-container",1),h.Mb()),2&e){const e=h.ac();h.zb(1),h.gc("ngIf",!e.isLoading)}}let K=(()=>{class e{constructor(e,t,r,s,n,i,a,o){this.route=e,this.ts=t,this.router=r,this.grs=s,this.grfs=n,this.recfs=i,this.recs=a,this.ems=o,this.isError=!1,this.fileControl=y,this.uploadConfig=g,this.attachmentConfig={name:"Image",type:"image"},this.isLoading=!1}ngOnInit(){let e=this.route.snapshot.data;this.systemType=e.create.systemType,this.systemGuideline=e.create.systemGuideline,this.title=e.create.title,this.view=e.create.view,this.link=e.create.link,this.grs.$systemType=this.systemType,this.route.paramMap.pipe(Object(p.a)(e=>{let t=e.get("request");return this.rslug=t,this.isLoading=!0,this.grs.addEntry(t)})).subscribe(e=>{if(null==e)this.isLoading=!1,this.isError=!0,this.error=Object.assign({resource:this.systemType+" Entry"},this.ems.message);else if(null!=e&&1==e.permitted){this.isLoading=!1;let t=e.$data;this.ts.setTitle(t.title),this.title=t.title,this.entryCreateForm=this.recfs.entryCreateForm(),this.entryCreateForm.addControl("unit",new n.c("",this.grfs.otherCtrls.unit)),this.entryCreateForm.addControl("request_type",new n.c("",this.grfs.otherCtrls.request_type)),this.entryCreateForm.patchValue({unit:t.unit,request_type:t.request_type}),this.entryCreateForm.updateValueAndValidity()}})}ngOnDestroy(){clearTimeout(this.entryCreateT)}createEntry(e){this.error=null,this.isError=!1,this.grs.addEntry$(this.rslug,e).subscribe(e=>{null==e?this.recs.isEntryCreated.next(!1):null!=e&&1==e.created&&(this.isLoading=!0,this.recs.isEntryCreated.next(!0),this.entryChanges(e))})}entryChanges(e){this.entryCreateT=setTimeout(()=>this.router.navigate(e&&e.slug?["general-request","t",this.rslug]:["general-request","t",this.rslug,"entries"]),5e3)}}return e.\u0275fac=function(t){return new(t||e)(h.Kb(o.a),h.Kb(d.b),h.Kb(o.d),h.Kb(q),h.Kb(I),h.Kb(O.a),h.Kb($.a),h.Kb(b.a))},e.\u0275cmp=h.Eb({type:e,selectors:[["app-gr-entry-create"]],features:[h.yb([b.a])],decls:5,vars:4,consts:[["id","entry-create"],[4,"ngIf"],[3,"error",4,"ngIf"],[3,"is-loading"],[3,"error"],[3,"system-type","system-guideline","view","input-file-control","attachment-config","entry-create-form","upload-config-u","processEntry"]],template:function(e,t){1&e&&(h.Pb(0,"div",0),h.vc(1,G,2,1,"h2",1),h.vc(2,F,1,1,"app-resource-unavailable",2),h.vc(3,z,2,1,"ng-container",1),h.Ob(),h.Lb(4,"app-loading-menu",3)),2&e&&(h.zb(1),h.gc("ngIf",t.title),h.zb(1),h.gc("ngIf",t.isError),h.zb(1),h.gc("ngIf",t.entryCreateForm),h.zb(1),h.gc("is-loading",t.isLoading))},directives:[s.l,j.a,L.a,k.a],styles:[""]}),e})(),P={systemType:"General Request",title:"General Request",view:"gr",viewWord:"GeneralRequest",link:"general-request",$link:"general-request",systemGuideline:"request",base:"general-request"};const R={create:Object.assign(Object.assign({},P),{title:"Request review of your semester "+P.systemType})},V=[{path:"",component:u,canActivate:[c.a],canLoad:[c.a],children:[{path:"",canActivateChild:[c.a],children:[{path:"",component:K,data:{create:R.create},canActivate:[l.a]}]}]}];let A=(()=>{class e{}return e.\u0275mod=h.Ib({type:e}),e.\u0275inj=h.Hb({factory:function(t){return new(t||e)},imports:[[o.g.forChild(V)],o.g]}),e})(),M=(()=>{class e{}return e.\u0275mod=h.Ib({type:e}),e.\u0275inj=h.Hb({factory:function(t){return new(t||e)},providers:[q,I],imports:[[s.b,n.l,A,a.a,i.a]]}),e})()}}]);