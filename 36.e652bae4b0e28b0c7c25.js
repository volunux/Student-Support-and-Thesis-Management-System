(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{"6lis":function(t,e,s){"use strict";s.r(e),s.d(e,"GeneralRequestEntryCreateModule",function(){return W});var i=s("Yvf7"),n=s("8VHZ"),r=s("hxwH"),a=s("0FyI"),o=s("Fk62"),c=s("jiyY"),l=s("iojP"),h=s("Ub9n");let u=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=h.Eb({type:t,selectors:[["app-gr-entry-create-homepage"]],decls:1,vars:0,template:function(t,e){1&t&&h.Lb(0,"router-outlet")},directives:[o.h],styles:[""]}),t})();var p=s("XA6Z");let y=[{label:"Photo I",key:"photos",accepts:"image/*",controlType:"file"},{label:"Photo II",key:"photos",accepts:"image/*",controlType:"file"},{label:"Photo III",key:"photos",accepts:"image/*",controlType:"file"},{label:"Photo IV",key:"photos",accepts:"image/*",controlType:"file"}],g={add:"user-upload/entry/create",remove:"o/photo",sign:"o/sign/photo"};var f=s("EUGn"),d=s("9nlD"),b=s("jV/k"),m=s("vfyW"),v=s("XRyL"),C=s("O6Zd"),q=s("oECA"),T=s("VcWf"),E=s("FBrc");let w=(()=>{class t{constructor(t,e,s){this.http=t,this.apiConfig=e,this.ems=s,this.$systemType="General Request",this.$sa="general-request"}addEntry(t){return this.http.get(`${this.apiConfig.host}/${this.$sa}/t/${t}/entry/create`).pipe(Object(m.a)(t=>console.log(t)),Object(v.a)(2e3),Object(C.a)(t=>({permitted:!0,$data:t})),Object(q.a)(this.handleError(this.$systemType+" Entry",null)))}addEntry$(t,e){return this.http.post(`${this.apiConfig.host}/${this.$sa}/t/${t}/entry/create`,e).pipe(Object(m.a)(t=>console.log(t)),Object(C.a)(t=>({created:!0,$data:t})),Object(q.a)(this.handleError(this.$systemType+" Entry",null)))}handleError(t="operation",e){return t=>(this.ems.message=t,Object(b.a)(e))}}return t.\u0275fac=function(e){return new(e||t)(h.Tb(E.b),h.Tb(T.b),h.Tb(f.a))},t.\u0275prov=h.Gb({token:t,factory:t.\u0275fac}),t})(),O=(()=>{class t{constructor(t){this.fb=t,this.permanentData={},this.otherCtrls={request_type:[n.q.required,n.q.max(9e7)],unit:[n.q.required,n.q.max(9e7)],username:[n.q.minLength(5),n.q.maxLength(100)],password:[n.q.minLength(5),n.q.maxLength(100)]}}getMyData(t){return this.permanentData[t]}}return t.\u0275fac=function(e){return new(e||t)(h.Tb(n.c))},t.\u0275prov=h.Gb({token:t,factory:t.\u0275fac}),t})();var I=s("5bm+"),$=s("WEao"),j=s("uMT1"),L=s("TY4h"),k=s("Rxsk"),G=s("wczn");function F(t,e){if(1&t&&(h.Pb(0,"h2"),h.xc(1),h.Ob()),2&t){const t=h.ac();h.zb(1),h.yc(" ",t.title," ")}}function N(t,e){if(1&t&&h.Lb(0,"app-resource-unavailable",5),2&t){const t=h.ac();h.gc("error",t.error)}}function x(t,e){if(1&t){const t=h.Qb();h.Pb(0,"app-notification-screen",6),h.Wb("finished",function(){return h.rc(t),h.ac().removeNotification()}),h.Ob()}if(2&t){const t=h.ac();h.gc("notified",t.notificationAvailable)("message",t.notificationMessage)}}function z(t,e){if(1&t){const t=h.Qb();h.Nb(0),h.Pb(1,"app-request-entry-create",7),h.Wb("processEntry",function(e){return h.rc(t),h.ac(2).createEntry(e)}),h.Ob(),h.Mb()}if(2&t){const t=h.ac(2);h.zb(1),h.gc("system-type",t.systemType)("system-guideline",t.systemGuideline)("view",t.view)("input-file-control",t.fileControl)("attachment-config",t.attachmentConfig)("entry-create-form",t.entryCreateForm)("upload-config-u",t.uploadConfig)}}function A(t,e){if(1&t&&(h.Nb(0),h.vc(1,z,2,7,"ng-container",1),h.Mb()),2&t){const t=h.ac();h.zb(1),h.gc("ngIf",!t.isLoading)}}let M=(()=>{class t{constructor(t,e,s,i,n,r,a,o){this.route=t,this.router=e,this.grs=s,this.grfs=i,this.recfs=n,this.recs=r,this.ems=a,this.ns=o,this.isError=!1,this.fileControl=y,this.uploadConfig=g,this.attachmentConfig={name:"Image",type:"image"},this.isLoading=!1}ngOnInit(){let t=this.route.snapshot.data;this.systemType=t.create.systemType,this.systemGuideline=t.create.systemGuideline,this.title=t.create.title,this.view=t.create.view,this.link=t.create.link,this.grs.$systemType=this.systemType,this.route.paramMap.pipe(Object(p.a)(t=>{let e=t.get("request");return this.rslug=e,this.isLoading=!0,this.grs.addEntry(e)})).subscribe(t=>{if(null==t)this.isLoading=!1,this.isError=!0,this.error=Object.assign({resource:this.systemType+" Entry"},this.ems.message);else if(null!=t&&1==t.permitted){this.isLoading=!1;let e=t.$data;this.title=e.title,this.entryCreateForm=this.recfs.entryCreateForm(),this.entryCreateForm.addControl("unit",new n.d("",this.grfs.otherCtrls.unit)),this.entryCreateForm.addControl("request_type",new n.d("",this.grfs.otherCtrls.request_type)),this.entryCreateForm.patchValue({unit:e.unit,request_type:e.request_type}),this.entryCreateForm.updateValueAndValidity()}})}ngOnDestroy(){clearTimeout(this.entryCreateT)}createEntry(t){this.error=null,this.isError=!1,this.grs.addEntry$(this.rslug,t).subscribe(t=>{null==t?(this.ns.setNotificationStatus(!0),this.ns.addNotification(`Operation is unsuccessful and ${this.systemType} is not added.`),this.recs.isEntryCreated.next(!1)):null!=t&&1==t.created&&(this.isLoading=!0,this.ns.setNotificationStatus(!0),this.ns.addNotification(`Operation is successful and ${this.systemType} is added.`),this.recs.isEntryCreated.next(!0),this.entryChanges(t))})}entryChanges(t){this.entryCreateT=setTimeout(()=>this.router.navigate(t&&t.slug?["general-request","t",this.rslug]:["general-request","t",this.rslug,"entries"]),5e3)}get notificationAvailable(){return this.ns.notificationStatus()}get notificationMessage(){return this.ns.getNotificationMessage()}removeNotification(){this.ns.removeNotification()}}return t.\u0275fac=function(e){return new(e||t)(h.Kb(o.a),h.Kb(o.e),h.Kb(w),h.Kb(O),h.Kb(I.a),h.Kb($.a),h.Kb(f.a),h.Kb(d.a))},t.\u0275cmp=h.Eb({type:t,selectors:[["app-gr-entry-create"]],features:[h.yb([f.a,d.a])],decls:6,vars:5,consts:[["id","entry-create"],[4,"ngIf"],[3,"error",4,"ngIf"],[3,"notified","message","finished",4,"ngIf"],[3,"is-loading"],[3,"error"],[3,"notified","message","finished"],[3,"system-type","system-guideline","view","input-file-control","attachment-config","entry-create-form","upload-config-u","processEntry"]],template:function(t,e){1&t&&(h.Pb(0,"div",0),h.vc(1,F,2,1,"h2",1),h.vc(2,N,1,1,"app-resource-unavailable",2),h.vc(3,x,1,2,"app-notification-screen",3),h.vc(4,A,2,1,"ng-container",1),h.Ob(),h.Lb(5,"app-loading-menu",4)),2&t&&(h.zb(1),h.gc("ngIf",e.title),h.zb(1),h.gc("ngIf",e.isError),h.zb(1),h.gc("ngIf",e.notificationAvailable),h.zb(1),h.gc("ngIf",e.entryCreateForm),h.zb(1),h.gc("is-loading",e.isLoading))},directives:[i.l,j.a,L.a,k.a,G.a],styles:[""]}),t})(),P={systemType:"General Request",title:"General Request",view:"gr",viewWord:"GeneralRequest",link:"general-request",$link:"general-request",systemGuideline:"request",base:"general-request"};const K={create:Object.assign(Object.assign({},P),{title:""+P.systemType})},R=[{path:"",component:u,canActivate:[c.a],canLoad:[c.a],children:[{path:"",canActivateChild:[c.a],children:[{path:"",component:M,data:{create:K.create},canActivate:[l.a]}]}]}];let V=(()=>{class t{}return t.\u0275mod=h.Ib({type:t}),t.\u0275inj=h.Hb({factory:function(e){return new(e||t)},imports:[[o.g.forChild(R)],o.g]}),t})(),W=(()=>{class t{}return t.\u0275mod=h.Ib({type:t}),t.\u0275inj=h.Hb({factory:function(e){return new(e||t)},providers:[w,O],imports:[[i.b,n.n,V,a.a,r.a]]}),t})()}}]);